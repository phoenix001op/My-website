<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Study Timer</title>
  <style>
    :root {
      --bg1: linear-gradient(135deg, #2b1055, #7597de);
      --bg2: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      --bg3: linear-gradient(135deg, #42275a, #734b6d);
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      min-height: 100vh;
      background: var(--bg1);
      color: white;
      transition: background 0.6s ease;
      position: relative;
    }
    .screen {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .container {
      background: rgba(0,0,0,0.35);
      backdrop-filter: blur(10px);
      padding: 30px 35px;
      border-radius: 28px;
      text-align: center;
      width: 100%;
      max-width: 520px;
      box-shadow: 0 25px 60px rgba(0,0,0,0.45);
      position: relative;
    }
    @media (max-width: 600px) {
      .container {
        max-width: 100%;
        height: 100vh;
        border-radius: 0;
        box-shadow: none;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }
    }
    h1 { margin-bottom: 10px; }
    .timer { font-size: 56px; font-weight: bold; margin: 20px 0; }
    .inputs input {
      width: 70px; padding: 6px; margin: 5px; border-radius: 8px; border: none; text-align: center;
    }
    button {
      padding: 10px 18px; margin: 6px; border-radius: 25px; border: none; cursor: pointer;
      font-weight: 600; background: #ff7ad9; color: white;
    }
    .row { display: flex; justify-content: center; flex-wrap: wrap; gap: 10px; }
    .hidden { display: none; }
    #calendarDays div, #statsDays div { cursor: pointer; padding: 10px; border-radius: 10px; text-align: center; }
    
    /* Music Player Styles */
    .music-player {
      position: fixed;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 20px;
      width: 220px;
      z-index: 100;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    .music-player.hidden {
      display: none;
    }
    .music-title {
      font-size: 18px;
      margin-bottom: 15px;
      color: #ff7ad9;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .music-controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 15px;
    }
    .music-btn {
      background: #ff7ad9;
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      cursor: pointer;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .music-btn:hover {
      background: #ff5ccd;
    }
    .track-selector {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .track-btn {
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: white;
      padding: 8px 12px;
      border-radius: 10px;
      cursor: pointer;
      text-align: left;
      font-size: 14px;
      transition: all 0.3s ease;
    }
    .track-btn:hover {
      background: rgba(255, 122, 217, 0.2);
    }
    .track-btn.active {
      background: #ff7ad9;
      color: white;
    }
    
    /* Calendar Styles */
    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .calendar-nav-btn {
      background: #ff7ad9;
      color: white;
      border: none;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .calendar-month-year {
      font-size: 18px;
      font-weight: bold;
    }
    .calendar-day-header {
      font-weight: bold;
      padding: 10px;
      background: rgba(255, 122, 217, 0.2);
      border-radius: 8px;
    }
    .calendar-day {
      padding: 12px;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }
    .calendar-day:hover {
      background: rgba(255, 122, 217, 0.1);
    }
    .calendar-day.has-data {
      background: rgba(255, 122, 217, 0.3);
    }
    .calendar-day.today {
      border: 2px solid #ff7ad9;
    }
    .study-minutes {
      font-size: 10px;
      position: absolute;
      bottom: 2px;
      right: 2px;
      background: rgba(0, 0, 0, 0.5);
      padding: 2px 4px;
      border-radius: 4px;
    }
    .date-details {
      margin-top: 20px;
      padding: 15px;
      background: rgba(255, 122, 217, 0.1);
      border-radius: 12px;
    }
    
    /* Login Page Improvements */
    .login-container {
      animation: fadeIn 0.8s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .welcome-title {
      font-size: 2.5em;
      margin-bottom: 10px;
      background: linear-gradient(45deg, #ff7ad9, #7597de);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .login-input {
      width: 100%;
      padding: 15px;
      border-radius: 15px;
      border: 2px solid rgba(255, 122, 217, 0.3);
      background: rgba(255, 255, 255, 0.1);
      color: white;
      font-size: 16px;
      margin: 20px 0;
      text-align: center;
      transition: all 0.3s ease;
    }
    .login-input:focus {
      outline: none;
      border-color: #ff7ad9;
      box-shadow: 0 0 15px rgba(255, 122, 217, 0.3);
    }
    .login-btn {
      padding: 15px 40px;
      font-size: 16px;
      background: linear-gradient(45deg, #ff7ad9, #ff5ccd);
      border: none;
      border-radius: 25px;
      color: white;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: bold;
      letter-spacing: 1px;
    }
    .login-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(255, 122, 217, 0.4);
    }
    .login-subtitle {
      color: rgba(255, 255, 255, 0.8);
      margin-bottom: 30px;
    }
    
    /* Responsive Music Player */
    @media (max-width: 1100px) {
      .music-player {
        left: 10px;
        width: 180px;
        padding: 15px;
      }
    }
    @media (max-width: 768px) {
      .music-player {
        position: fixed;
        top: auto;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        width: 90%;
        max-width: 300px;
      }
    }
  </style>
</head>
<body>

<!-- LOGIN SCREEN -->
<div class="screen" id="loginScreen">
  <div class="container login-container">
    <h1 class="welcome-title">üëã Welcome to Padh lo </h1>
    <p class="login-subtitle">Track your study sessions and boost productivity</p>
    <input id="usernameInput" placeholder="Enter your name" class="login-input" />
    <br><br>
    <button class="login-btn" onclick="login()">Start Studying ‚Üí</button>
  </div>
</div>

<!-- MUSIC PLAYER -->
<div class="music-player hidden" id="musicPlayer">
  <div class="music-title">üéµ Relax Music</div>
  <div class="music-controls">
    <button class="music-btn" onclick="playMusic()">‚ñ∂Ô∏è</button>
    <button class="music-btn" onclick="pauseMusic()">‚è∏Ô∏è</button>
    <button class="music-btn" onclick="stopMusic()">‚èπÔ∏è</button>
  </div>
  <div class="track-selector">
    <button class="track-btn active" onclick="selectTrack(1)">üéµ Drifting Away</button>
    <button class="track-btn" onclick="selectTrack(2)">üéµ Piano Relaxation</button>
    <button class="track-btn" onclick="selectTrack(3)">üéµ Nature Sounds</button>
    <button class="track-btn" onclick="selectTrack(4)">üéµ Focus Ambient</button>
  </div>
</div>

<!-- MAIN APP -->
<div class="screen hidden" id="appScreen">
  <div class="container" id="mainPage">
    <div style="position:absolute; top:20px; right:20px; cursor:pointer; display:flex; gap:10px;">
      <span onclick="toggleMusicPlayer()">üéµ</span>
      <span onclick="openCalendar()">üìÖ</span>
    </div>
    <div style="position:absolute; top:20px; left:20px; font-size:14px;" id="userLabel"></div>

    <h1>üìö Padh lo</h1>
    <div class="timer" id="display">00:00:00</div>
    <div id="status">Ready to study üìñ</div>

    <div class="inputs">
      <input type="number" id="setHr" placeholder="Hr" min="0">
      <input type="number" id="setMin" placeholder="Min" min="0" max="59">
      <input type="number" id="setSec" placeholder="Sec" min="0" max="59">
    </div>

    <div class="row">
      <button onclick="startTimer()">Start</button>
      <button onclick="pauseTimer()">Pause</button>
      <button onclick="resetTimer()">Reset</button>
    </div>

    <div class="row">
      <button onclick="toggleBreak()">‚òï Break</button>
      <button onclick="toggleBg()">üé® Background</button>
      <button onclick="openStats()">üìä Stats</button>
    </div>

    <div id="breakOptions" class="row hidden">
      <button onclick="startBreak(5)">5 Min</button>
      <button onclick="startBreak(10)">10 Min</button>
    </div>

    <div id="bgOptions" class="row hidden">
      <button onclick="changeBg(1)">Purple</button>
      <button onclick="changeBg(2)">Ocean</button>
      <button onclick="changeBg(3)">Sunset</button>
    </div>
  </div>
</div>

<!-- CALENDAR -->
<div class="screen hidden" id="calendarPage">
  <div class="container">
    <div style="position:absolute; top:20px; left:20px; cursor:pointer;" onclick="closeCalendar()">‚¨ÖÔ∏è</div>
    <h1>üìÖ Calendar</h1>
    
    <div class="calendar-header">
      <button class="calendar-nav-btn" onclick="changeCalendarMonth(-1)">‚óÄ</button>
      <div class="calendar-month-year" id="calendarMonthYear"></div>
      <button class="calendar-nav-btn" onclick="changeCalendarMonth(1)">‚ñ∂</button>
    </div>
    
    <div id="streak"></div>
    
    <div style="display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-top:15px;margin-bottom:15px;">
      <div class="calendar-day-header">Sun</div>
      <div class="calendar-day-header">Mon</div>
      <div class="calendar-day-header">Tue</div>
      <div class="calendar-day-header">Wed</div>
      <div class="calendar-day-header">Thu</div>
      <div class="calendar-day-header">Fri</div>
      <div class="calendar-day-header">Sat</div>
    </div>
    
    <div id="calendarDays" style="display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-bottom:20px;"></div>
    
    <div id="dateDetails" class="date-details hidden">
      <h3 id="selectedDateTitle"></h3>
      <p id="selectedDateStudyTime"></p>
    </div>
  </div>
</div>

<!-- STATS -->
<div class="screen hidden" id="statsPage">
  <div class="container">
    <div style="position:absolute; top:20px; left:20px; cursor:pointer;" onclick="closeStats()">‚¨ÖÔ∏è</div>
    <h1>üìä Stats</h1>
    <div id="weekly"></div>
    <div id="monthly" style="margin-top:15px"></div>
  </div>
</div>

<audio id="endSound" src="zapsplat_multimedia_end_ping_timer_003_68790.mp3"></audio>

<script>
// ========== MUSIC SETUP - WITH YOUR MP3 FILE ==========
const MUSIC_TRACKS = [
  "drifting-away-full-version-binaural-beats-409329.mp3",
  "https://cdn.pixabay.com/download/audio/2022/03/10/audio_4b8a1d9a4d.mp3?filename=relaxing-piano-111573.mp3",
  "https://cdn.pixabay.com/download/audio/2022/03/19/audio_1e5b5d9a0a.mp3?filename=nature-sounds-112364.mp3",
  "https://cdn.pixabay.com/download/audio/2022/03/07/audio_8b8a1d9a4d.mp3?filename=ambient-study-111208.mp3"
];

let interval=null, totalCs=0, studyStart=null;
let currentCalendarMonth = new Date().getMonth();
let currentCalendarYear = new Date().getFullYear();
let currentMusicTrack = 1;
let audioPlayer = new Audio();

// Music player functions
function toggleMusicPlayer() {
  const player = document.getElementById('musicPlayer');
  player.classList.toggle('hidden');
}

function playMusic() {
  audioPlayer.play();
}

function pauseMusic() {
  audioPlayer.pause();
}

function stopMusic() {
  audioPlayer.pause();
  audioPlayer.currentTime = 0;
}

function selectTrack(track) {
  currentMusicTrack = track;
  
  // Remove active class from all buttons
  document.querySelectorAll('.track-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  
  // Add active class to selected button
  event.target.classList.add('active');
  
  // Set music source from the array (your MP3 is track 1)
  audioPlayer.src = MUSIC_TRACKS[track - 1];
  audioPlayer.loop = true;
  
  // If already playing, continue playing with new track
  if (!audioPlayer.paused) {
    audioPlayer.play();
  }
}

// Initialize music player with first track (your MP3)
window.addEventListener('load', () => {
  selectTrack(1);
});

// Calendar functions
function renderCalendar() {
  const data = JSON.parse(localStorage.getItem('studyData') || '{}');
  const calendarDays = document.getElementById('calendarDays');
  const monthYear = document.getElementById('calendarMonthYear');
  
  // Set month and year
  const monthNames = ["January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December"];
  monthYear.textContent = `${monthNames[currentCalendarMonth]} ${currentCalendarYear}`;
  
  // Get first day of month and total days
  const firstDay = new Date(currentCalendarYear, currentCalendarMonth, 1);
  const lastDay = new Date(currentCalendarYear, currentCalendarMonth + 1, 0);
  const totalDays = lastDay.getDate();
  const startingDay = firstDay.getDay();
  
  calendarDays.innerHTML = '';
  
  // Add empty cells for days before first day of month
  for (let i = 0; i < startingDay; i++) {
    const emptyDiv = document.createElement('div');
    calendarDays.appendChild(emptyDiv);
  }
  
  const today = new Date();
  
  // Add days of the month
  for (let day = 1; day <= totalDays; day++) {
    const dayDiv = document.createElement('div');
    dayDiv.className = 'calendar-day';
    
    const dateStr = `${currentCalendarYear}-${String(currentCalendarMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
    
    // Check if today
    if (currentCalendarYear === today.getFullYear() && 
        currentCalendarMonth === today.getMonth() && 
        day === today.getDate()) {
      dayDiv.classList.add('today');
    }
    
    // Check if has study data
    if (data[dateStr]) {
      dayDiv.classList.add('has-data');
      const minutesDiv = document.createElement('div');
      minutesDiv.className = 'study-minutes';
      minutesDiv.textContent = `${data[dateStr]}m`;
      dayDiv.appendChild(minutesDiv);
    }
    
    dayDiv.textContent = day;
    dayDiv.onclick = () => showDateStudyTime(dateStr, day);
    calendarDays.appendChild(dayDiv);
  }
  
  // Calculate streak
  let streak = 0;
  let checkDate = new Date();
  while (data[checkDate.toISOString().split('T')[0]] >= 15) {
    streak++;
    checkDate.setDate(checkDate.getDate() - 1);
  }
  document.getElementById('streak').innerHTML = `üî• Current Streak: ${streak} day(s)`;
}

function changeCalendarMonth(change) {
  currentCalendarMonth += change;
  if (currentCalendarMonth < 0) {
    currentCalendarMonth = 11;
    currentCalendarYear--;
  } else if (currentCalendarMonth > 11) {
    currentCalendarMonth = 0;
    currentCalendarYear++;
  }
  renderCalendar();
}

function showDateStudyTime(dateStr, day) {
  const data = JSON.parse(localStorage.getItem('studyData') || '{}');
  const minutes = data[dateStr] || 0;
  const hours = Math.floor(minutes / 60);
  const remainingMinutes = minutes % 60;
  
  const monthNames = ["January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December"];
  
  document.getElementById('selectedDateTitle').textContent = 
    `${monthNames[currentCalendarMonth]} ${day}, ${currentCalendarYear}`;
  
  if (minutes > 0) {
    document.getElementById('selectedDateStudyTime').innerHTML = 
      `üìö Padh lo: <strong>${hours > 0 ? `${hours}h ` : ''}${remainingMinutes}m</strong>`;
  } else {
    document.getElementById('selectedDateStudyTime').textContent = 
      'No study recorded for this date';
  }
  
  document.getElementById('dateDetails').classList.remove('hidden');
}

// Existing functions (unchanged)
function login(){
  const name=usernameInput.value.trim();
  if(!name) return alert('Enter name');
  localStorage.setItem('username',name);
  initApp();
}

function initApp(){
  const name=localStorage.getItem('username');
  if(!name) return;
  loginScreen.classList.add('hidden');
  appScreen.classList.remove('hidden');
  userLabel.innerText='üë§ '+name;
}

window.onload=function() {
  initApp();
  renderCalendar();
};

function updateDisplay(){
  let s=Math.floor(totalCs/100);
  display.innerText=`${String(Math.floor(s/3600)).padStart(2,'0')}:${String(Math.floor(s/60)%60).padStart(2,'0')}:${String(s%60).padStart(2,'0')}`;
}

function startTimer(){
  if(interval) return;
  if(totalCs===0){ totalCs=((+setHr.value||0)*3600+(+setMin.value||0)*60+(+setSec.value||0))*100; }
  studyStart=Date.now();
  status.innerText='üìñ Study started';
  interval=setInterval(()=>{ totalCs>0?(totalCs--,updateDisplay()):finishTimer(); },10);
}

function finishTimer(){ clearInterval(interval); interval=null; endSound.play(); saveStudy(); }
function pauseTimer(){ if(!interval) return; clearInterval(interval); interval=null; saveStudy(); }
function resetTimer(){ pauseTimer(); totalCs=0; updateDisplay(); status.innerText='Ready to study üìñ'; }
function startBreak(m){ resetTimer(); totalCs=m*6000; status.innerText='‚òï Break started'; startTimer(); }

function saveStudy(){
  if(!studyStart) return;
  const min=Math.floor((Date.now()-studyStart)/60000);
  studyStart=null;
  if(min<=0) return;
  const d=new Date().toISOString().split('T')[0];
  const data=JSON.parse(localStorage.getItem('studyData')||'{}');
  data[d]=(data[d]||0)+min;
  localStorage.setItem('studyData',JSON.stringify(data));
  renderCalendar();
}

function toggleBreak(){ breakOptions.classList.toggle('hidden'); bgOptions.classList.add('hidden'); }
function toggleBg(){ bgOptions.classList.toggle('hidden'); breakOptions.classList.add('hidden'); }
function changeBg(v){ document.body.style.background=v==1?'var(--bg1)':v==2?'var(--bg2)':'var(--bg3)'; }

function openCalendar(){ 
  appScreen.classList.add('hidden'); 
  calendarPage.classList.remove('hidden'); 
  renderCalendar(); 
}
function closeCalendar(){ 
  calendarPage.classList.add('hidden'); 
  appScreen.classList.remove('hidden'); 
}

function openStats(){ appScreen.classList.add('hidden'); statsPage.classList.remove('hidden'); renderStats(); }
function closeStats(){ statsPage.classList.add('hidden'); appScreen.classList.remove('hidden'); }

function renderStats(){
  const data=JSON.parse(localStorage.getItem('studyData')||'{}');
  let week=0, month=0; const now=new Date();
  for(let k in data){ const d=new Date(k); if((now-d)/86400000<7) week+=data[k]; if(d.getMonth()==now.getMonth()) month+=data[k]; }
  weekly.innerText=`üóìÔ∏è Last 7 days: ${Math.floor(week/60)}h ${week%60}m`;
  monthly.innerText=`üìÜ This month: ${Math.floor(month/60)}h ${month%60}m`;
}
</script>
</body>
</html>